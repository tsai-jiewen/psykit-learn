<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title> ConQuest計分檔的分割函數 | ⌾ JackMD</title>
    
    
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link rel="stylesheet" href="/css/custom.css" />
    <link href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="ConQuest計分檔的分割函數"/>
<meta name="twitter:description" content="讀取計分檔。 記得用 read_table()，若用 read_csv() 因為是逗點切割，所以會全部分成一個欄位。 tds &lt;- read_table(&#39;TDS.txt&#39;, col_names = FALSE) ConQuest的計分檔（.txt）用"/>


  </head>

  <body>

    <nav class="menu">
    <ul>
      <li class="left">
        <a href="/"><span>⌾ JackMD</span></a>
      </li>
      
      <li>
        <a href="/">Home</a>
      </li>
      
      <li>
        <a href="/about/">About</a>
      </li>
      
      <li>
        <a href="/sitemap/">Sitemap</a>
      </li>
      
      <li>
        <a href="/post">Posts</a>
      </li>
      
      <li id="menu-search">
        <a href="/#">🔍Search</a>
      </li>
      
    </ul>
    </nav>


<div class="container single">
<main>

<div class="article-meta">
<h1><span class="title">ConQuest計分檔的分割函數</span></h1>

<h3 class="author">
Jiewen Tsai
</h3>

<h3 class="date">2021-03-26</h3>
<p class="terms">
  
  
  
  
  Tags: <a href="/tags/r">R</a> <a href="/tags/conquest">ConQuest</a> 
  
  
</p>
</div>

<div class="article">
<h2 id="讀取計分檔">讀取計分檔。</h2>
<p>記得用 <code>read_table()</code>，若用 <code>read_csv()</code> 因為是逗點切割，所以會全部分成一個欄位。</p>
<pre><code class="language-r=">tds &lt;- read_table('TDS.txt', col_names = FALSE)
</code></pre>
<p>ConQuest的計分檔（.txt）用R讀取後長這樣子：</p>
<pre><code class="language-r">&gt; tds
# A tibble: 413 x 3
      X1    X2 X3                    
   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;                 
 1     1     1 0122122211121231211113
 2     2     1 1111112212311221220121
 3     3     1 3233122012332333131001
 4     4     1 2212123221110332332212
 5     5     1 3320231030333322232332
 6     6     1 0232221222020232223222
 7     7     1 1111133223131223230012
 8     8     1 2223222222332322111221
 9     9     1 2131133231331132331111
10    10     1 0220122222330322123022
# … with 403 more rows
</code></pre>
<p>其中，X3欄位是分數，但是只有1個欄位。要切分成22個欄位（tidy）才能用<code>eRm</code>、<code>TAM</code>等pkg做後續處理。</p>
<p>另解：
當 CQ 的資料檔沒有空白格分開時，用 <code>read_table()</code> 讀取會變成數值，而不是 chr。
所以可以改用 <code>read_csv()</code> 指定欄位格式 <code>col_types = 'c'</code>。</p>
<pre><code class="language-=">ch114_txt &lt;- read_csv('CH11-4.txt', col_types = 'c', col_names = FALSE)
</code></pre>
<h2 id="欄位切割函數">欄位切割函數</h2>
<p>但一直沒找到可以做這個切分工作的函數。所以就自己寫一個吧！</p>
<pre><code class="language-r=">item_split &lt;- function(dat, n) {
  require(tidyverse)
  require(stringr)
  l &lt;- list()
  for (i in 1:n) {
    l[[i]] &lt;- dat %&gt;% str_sub(i, i) %&gt;% as.numeric()
  }
  i = i + 1
  
  df &lt;- matrix(unlist(l), nrow = length(l), byrow = T) %&gt;% t() %&gt;% as_tibble()
  df
}

</code></pre>
<p>參數：</p>
<ul>
<li>dat：原資料欄位</li>
<li>n：切分後欄位數</li>
</ul>
<p>概念上就是用 <code>stringr::str_sub()</code> 函數，直向抽取數值。並存到 list 裡面。
再轉存成tibble型態。</p>
<hr>
<h2 id="測試">測試</h2>
<p>測試檔：台灣憂鬱量表（TDS），共 413 個觀察值，22 個題目。
用自編的 <code>item_split()</code> 函數切割檔案 <code>tds$X3</code>，存成 A。</p>
<pre><code class="language-r">&gt; A &lt;- item_split(tds$X3, 22) 
&gt; A
# A tibble: 413 x 22
      V1    V2    V3    V4    V5    V6    V7    V8    V9   V10   V11   V12
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1     0     1     2     2     1     2     2     2     1     1     1     2
 2     1     1     1     1     1     1     2     2     1     2     3     1
 3     3     2     3     3     1     2     2     0     1     2     3     3
 4     2     2     1     2     1     2     3     2     2     1     1     1
 5     3     3     2     0     2     3     1     0     3     0     3     3
 6     0     2     3     2     2     2     1     2     2     2     0     2
 7     1     1     1     1     1     3     3     2     2     3     1     3
 8     2     2     2     3     2     2     2     2     2     2     3     3
 9     2     1     3     1     1     3     3     2     3     1     3     3
10     0     2     2     0     1     2     2     2     2     2     3     3
# … with 403 more rows, and 10 more variables: V13 &lt;dbl&gt;, V14 &lt;dbl&gt;,
#   V15 &lt;dbl&gt;, V16 &lt;dbl&gt;, V17 &lt;dbl&gt;, V18 &lt;dbl&gt;, V19 &lt;dbl&gt;, V20 &lt;dbl&gt;,
#   V21 &lt;dbl&gt;, V22 &lt;dbl&gt;
</code></pre>
<p>用最簡單的 <code>eRm</code> 套件進行分析：</p>
<pre><code class="language-r">&gt; eRm::PCM(A)

Results of PCM estimation: 

Call:  eRm::PCM(X = A) 

Conditional log-likelihood: -7139.254 
Number of iterations: 26 
Number of parameters: 65 

Item (Category) Difficulty Parameters (eta):
             V1.c2     V1.c3      V2.c1     V2.c2     V2.c3      V3.c1
Estimate 2.9373691 5.5004023 -0.5026313 0.5687929 2.7167951 -1.5891000
Std.Err  0.2080597 0.2905613  0.1378363 0.1852051 0.2379407  0.1445418
              V3.c2     V3.c3      V4.c1     V4.c2    V4.c3      V5.c1
Estimate -0.8842344 0.8283488 -0.3306218 1.2087767 3.667884 -0.8075350
Std.Err   0.1886138 0.2256532  0.1342302 0.1896171 0.258974  0.1355271
             V5.c2     V5.c3      V6.c1      V6.c2     V6.c3      V7.c1
Estimate 0.4579519 2.6152032 -1.5040463 -0.9743534 0.9923865 -3.1159230
Std.Err  0.1873378 0.2405321  0.1447854  0.1847781 0.2293673  0.1990869
              V7.c2     V7.c3      V8.c1       V8.c2     V8.c3      V9.c1
Estimate -3.1577746 -1.809449 -1.1221083 -0.05397499 2.1979582 -2.8551508
Std.Err   0.2259857  0.250966  0.1374213  0.18499937 0.2409469  0.1870406
              V9.c2      V9.c3     V10.c1    V10.c2    V10.c3     V11.c1
Estimate -2.9527754 -1.5478484 -0.5974519 0.4555994 2.8793634 -0.7175797
Std.Err   0.2148776  0.2424618  0.1371351 0.1829607 0.2470719  0.1349900
            V11.c2    V11.c3     V12.c1     V12.c2    V12.c3     V13.c1
Estimate 0.7249513 2.5141733 -1.6997940 -1.2915658 0.3104866 -0.2294872
Std.Err  0.1932825 0.2319935  0.1487864  0.1885285 0.2233758  0.1365726
            V13.c2   V13.c3     V14.c1     V14.c2     V14.c3    V15.c1
Estimate 1.3097317 2.977850 -1.1828484 -1.1855359 -0.3675684 -2.437145
Std.Err  0.1975586 0.231255  0.1515045  0.1893085  0.2119602  0.176375
             V15.c2     V15.c3     V16.c1     V16.c2    V16.c3     V17.c1
Estimate -2.8811047 -1.3132456 -2.0019023 -1.3900573 0.7428773 -1.1841216
Std.Err   0.2009328  0.2338507  0.1513078  0.1901427 0.2381854  0.1401928
             V17.c2    V17.c3     V18.c1     V18.c2   V18.c3     V19.c1
Estimate -0.3707148 1.5191147 -1.6189003 -0.7536189 1.222898 -0.8050713
Std.Err   0.1855372 0.2282181  0.1432545  0.1881159 0.232705  0.1341039
            V19.c2   V19.c3     V20.c1    V20.c2    V20.c3     V21.c1
Estimate 0.7225196 2.649148 -0.6201066 0.2792573 2.6452431 -1.0266341
Std.Err  0.1932131 0.237228  0.1385045 0.1818370 0.2426987  0.1392295
             V21.c2    V21.c3     V22.c1     V22.c2   V22.c3
Estimate -0.1349207 1.6591516 -1.2801121 -0.4725497 1.514371
Std.Err   0.1865880 0.2263306  0.1405882  0.1851690 0.230810

</code></pre>
<p>可以哦！</p>
<p>person-item map</p>
<p><img src="https://i.imgur.com/PxN5CPk.png" alt=""></p>
<pre><code class="language-r=">mod1 &lt;- tam.mml(A)
persons.mod1 &lt;- tam.wle( mod1 )
thresholds.mod1 &lt;- tam.threshold(mod1)

wrightMap(persons.mod1$theta, thresholds.mod1, item.side = itemClassic)
</code></pre>
<p><img src="https://i.imgur.com/H5UKnVk.png" alt="itemClassic"></p>
<p><img src="https://i.imgur.com/9vfW3LB.png" alt="itemModern"></p>
<p>$$\dfrac{1}{2}$$</p>

</div>
</main>

<section class="appendix">


<div>
  <div class="side side-left"><h3>Author&#39;s bio</h3></div>
  <div>



<div><a href="https://jackmd.netlify.app">Jiewen Tsai</a> is a PhD student in Education of National ChengChi University, Taiwan.</div>


</div>
</div>






<div>
  <div class="side side-left"><h3>Reuse</h3></div>
  <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>.
</div>






<div>
  <div class="side side-left"><h3>Citation</h3></div>
  <p>For attribution, please cite this work as</p>
  <pre><code class="no-highlight">Jiewen Tsai (2021). ConQuest計分檔的分割函數. ⌾ JackMD. /post/2021/03/26/conquest%E8%A8%88%E5%88%86%E6%AA%94%E7%9A%84%E5%88%86%E5%89%B2%E5%87%BD%E6%95%B8/</code></pre>
  <p>BibTeX citation</p>
  <pre><code class="no-highlight">@misc{
  title = "ConQuest計分檔的分割函數",
  author = "Jiewen Tsai",
  year = "2021",
  journal = "⌾ JackMD",
  note = "/post/2021/03/26/conquest%E8%A8%88%E5%88%86%E6%AA%94%E7%9A%84%E5%88%86%E5%89%B2%E5%87%BD%E6%95%B8/"
}</code></pre>
</div>

</section>



<nav class="post-nav">
  <span class="nav-next">&larr; <a href="/post/2020/12/01/hello-r-markdown/" title=Next&#32;post&#32;(older)>Hello R Markdown</a></span>
  &hercon;
  <span class="nav-prev"><a href="/post/2021/04/10/structural-topic-modeling-a-trial/" title=Previous&#32;post&#32;(newer)>Structural topic modeling: a trial</a> &rarr;</span>
</nav>




<section class="comments">
  <div id="disqus_thread"></div>
  <script>
  var disqus_config = function () {
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var disqus_js = '//https-jackmd-netlify-app.disqus.com/embed.js';
    var d = document, s = d.createElement('script');
    s.src = disqus_js; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    var t = d.getElementById('disqus_thread');
    var b = false, l = function(scroll) {
      if (b) return;
      (d.head || d.body).appendChild(s); b = true;
      if (scroll) t.scrollIntoView();
    }
    s.onerror = function(e) {
      if (sessionStorage.getItem('failure-note')) return;
      t.innerText = 'Sorry, but you cannot make comments because Disqus failed to load for some reason. It is known to be blocked in China. If you are sure it is not blocked in your region, please refresh the page. 中国大陆地区读者需要翻墙才能发表评论。';
      t.style.border = '1px dashed';
      t.style.padding = '.5em';
      t.style.background = 'lightyellow';
      sessionStorage.setItem('failure-note', true);
    };
    
    if (location.hash.match(/^#comment-[0-9]+$/)) return l(true);
    var c = function() {
      if (b) return;
      var rect = t.getBoundingClientRect();
      if (rect.top < window.innerHeight && rect.bottom >= 0) l();
    };
    window.addEventListener('load', c);
    d.addEventListener('scroll', c);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>


</div>


  <footer>
  <script async src="//yihui.org/js/center-img.js"></script>



<script src="//yihui.org/js/math-code.js"></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>





<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script>
hljs.configure({languages: []});
hljs.initHighlightingOnLoad();
</script>


  <div class="footer">
  
  <ul class="copyright">
    <li>© <a href="/">Jiewen Tsai</a> 2021</li>
  </ul>
  
  <ul>
    
    <li>
      <a href="https://github.com/tsai-jiewen">Github</a>
    </li>
    
    <li>
      <a href="/index.xml">RSS</a>
    </li>
    
    <li id="menu-edit">
      <a href="#">Suggest an edit</a>
    </li>
    
    <li>
      <a href="#">Back to top</a>
    </li>
    
  </ul>
  </div>
  
  </footer>
  <script async src="/js/features.js" data-page-features="[null,[&#34;&#43;sidenotes&#34;],null]"></script>
  </body>
</html>

