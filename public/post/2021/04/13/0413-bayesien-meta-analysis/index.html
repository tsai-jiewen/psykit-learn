

<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title> 0413 bayesien meta-analysis | ⌾ JackMD</title>
    
    
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link rel="stylesheet" href="/css/custom.css" />
    <link href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="0413 bayesien meta-analysis"/>
<meta name="twitter:description" content="#install.packages(&quot;gemtc&quot;) #install.packages(&quot;netmeta&quot;) #install.packages(&quot;rjags&quot;) library(gemtc) ## Loading required package: coda library(netmeta) ## Loading required package: meta ## Loading &#39;meta&#39; package (version 4.16-1). ## Type &#39;help(meta)&#39; for a brief overview. ## ## Attaching package: &#39;meta&#39; ## The following object is masked from &#39;package:gemtc&#39;: ## ## forest ## Loading &#39;netmeta&#39; package (version 1.3-0). ## Type &#39;help(&quot;netmeta-package&quot;)&#39; for a brief overview. library(rjags) ## Linked to JAGS 4.3.0 ## Loaded modules: basemod,bugs library(rio) library(igraph) ##"/>


  </head>

  <body>

    <nav class="menu">
    <ul>
      <li class="left">
        <a href="/"><span>⌾ JackMD</span></a>
      </li>
      
      <li>
        <a href="/">Home</a>
      </li>
      
      <li>
        <a href="/about/">About</a>
      </li>
      
      <li>
        <a href="/sitemap/">Sitemap</a>
      </li>
      
      <li>
        <a href="/post">Posts</a>
      </li>
      
      <li id="menu-search">
        <a href="/#">🔍Search</a>
      </li>
      
    </ul>
    </nav>


<div class="container single">
<main>

<div class="article-meta">
<h1><span class="title">0413 bayesien meta-analysis</span></h1>

<h3 class="author">
Jiewen Tsai</h3>

<h3 class="date">2021-04-13</h3>
<p class="terms">
  
  
  
  
  Tags: <a href="/tags/r">R</a> <a href="/tags/bayesien">bayesien</a> <a href="/tags/meta-analysis">meta-analysis</a> 
  
  
</p>
</div>

<div class="article">

<script src="/post/2021/04/13/0413-bayesien-meta-analysis/index_files/header-attrs/header-attrs.js"></script>


<pre class="r"><code>#install.packages(&quot;gemtc&quot;)
#install.packages(&quot;netmeta&quot;)
#install.packages(&quot;rjags&quot;)

library(gemtc)</code></pre>
<pre><code>## Loading required package: coda</code></pre>
<pre class="r"><code>library(netmeta)</code></pre>
<pre><code>## Loading required package: meta</code></pre>
<pre><code>## Loading &#39;meta&#39; package (version 4.16-1).
## Type &#39;help(meta)&#39; for a brief overview.</code></pre>
<pre><code>## 
## Attaching package: &#39;meta&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:gemtc&#39;:
## 
##     forest</code></pre>
<pre><code>## Loading &#39;netmeta&#39; package (version 1.3-0).
## Type &#39;help(&quot;netmeta-package&quot;)&#39; for a brief overview.</code></pre>
<pre class="r"><code>library(rjags)</code></pre>
<pre><code>## Linked to JAGS 4.3.0</code></pre>
<pre><code>## Loaded modules: basemod,bugs</code></pre>
<pre class="r"><code>library(rio)
library(igraph)</code></pre>
<pre><code>## 
## Attaching package: &#39;igraph&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     decompose, spectrum</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     union</code></pre>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.3     ✓ purrr   0.3.4
## ✓ tibble  3.0.5     ✓ dplyr   1.0.3
## ✓ tidyr   1.1.2     ✓ stringr 1.4.0
## ✓ readr   1.4.0     ✓ forcats 0.5.0</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::as_data_frame() masks tibble::as_data_frame(), igraph::as_data_frame()
## x purrr::compose()       masks igraph::compose()
## x tidyr::crossing()      masks igraph::crossing()
## x dplyr::filter()        masks stats::filter()
## x dplyr::groups()        masks igraph::groups()
## x dplyr::lag()           masks stats::lag()
## x purrr::simplify()      masks igraph::simplify()</code></pre>
<div id="excel-import" class="section level3">
<h3>(Excel import)</h3>
<pre class="r"><code># data(Senn2013)
data &lt;- import(&#39;data.xlsx&#39;) %&gt;% select(-`...1`)</code></pre>
<pre><code>## New names:
## * `` -&gt; ...1</code></pre>
<pre class="r"><code>data$treatment &lt;- as.factor(data$treatment)</code></pre>
<pre class="r"><code>network &lt;- mtc.network(data)

summary(network)</code></pre>
<pre><code>## $Description
## [1] &quot;MTC dataset: Network&quot;
## 
## $`Studies per treatment`
##      Acarbose    Benfluorex     Metformin      Miglitol  Pioglitazone 
##             3             2             8             3             3 
##       Placebo Rosiglitazone   Sitagliptin  Sulfonylurea  Vildagliptin 
##            19            10             1             3             1 
## 
## $`Number of n-arm studies`
## 2-arm 3-arm 
##    25     1 
## 
## $`Studies per treatment comparison`
##               t1            t2 nr
## 1       Acarbose     Metformin  1
## 2       Acarbose       Placebo  2
## 3       Acarbose  Sulfonylurea  1
## 4     Benfluorex       Placebo  2
## 5      Metformin  Pioglitazone  1
## 6      Metformin       Placebo  4
## 7      Metformin Rosiglitazone  2
## 8      Metformin  Sulfonylurea  1
## 9       Miglitol       Placebo  3
## 10  Pioglitazone       Placebo  1
## 11  Pioglitazone Rosiglitazone  1
## 12       Placebo Rosiglitazone  6
## 13       Placebo   Sitagliptin  1
## 14       Placebo  Vildagliptin  1
## 15 Rosiglitazone  Sulfonylurea  1</code></pre>
<pre class="r"><code>plot(network)</code></pre>
<p><img src="/post/2021/04/13/0413-bayesien-meta-analysis/index_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>plot(network, layout=layout.fruchterman.reingold)</code></pre>
<p><img src="/post/2021/04/13/0413-bayesien-meta-analysis/index_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<pre class="r"><code>network$data.ab &lt;- network$data.ab %&gt;% rename(mean = diff)

network$data.ab$mean &lt;- as.numeric(as.integer(as.factor(network$data.ab$mean)))
network$data.ab$std.err &lt;- as.numeric(as.integer(as.factor(network$data.ab$std.err)))

#network$data.ab$mean &lt;- replace_na(network$data.ab$mean, 0)
#network$data.ab$std.err &lt;- replace_na(network$data.ab$std.err, 0)</code></pre>
</div>
<div id="模型編譯" class="section level3">
<h3>模型編譯</h3>
<pre class="r"><code>model &lt;- mtc.model(
  network,
  linearModel = &#39;random&#39;,
  n.chain = 4
)</code></pre>
<pre class="r"><code>mcmc1 &lt;- mtc.run(model, n.adapt = 50, n.iter = 1000, thin = 10)</code></pre>
<pre><code>## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 53
##    Unobserved stochastic nodes: 63
##    Total graph size: 730
## 
## Initializing model</code></pre>
<pre><code>## Warning in rjags::jags.model(file.model, data = syntax[[&quot;data&quot;]], inits =
## syntax[[&quot;inits&quot;]], : Adaptation incomplete</code></pre>
<pre><code>## NOTE: Stopping adaptation</code></pre>
<pre class="r"><code>mcmc2 &lt;- mtc.run(model, n.adapt = 5000, n.iter = 100000, thin = 10)</code></pre>
<pre><code>## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 53
##    Unobserved stochastic nodes: 63
##    Total graph size: 730
## 
## Initializing model</code></pre>
<pre class="r"><code>mcmc3 &lt;- mtc.run(model, n.adapt = 5000, n.iter = 100000, thin = 1)</code></pre>
<pre><code>## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 53
##    Unobserved stochastic nodes: 63
##    Total graph size: 730
## 
## Initializing model</code></pre>
</div>
<div id="section" class="section level3">
<h3></h3>
<pre class="r"><code>plot(mcmc1)</code></pre>
<p><img src="/post/2021/04/13/0413-bayesien-meta-analysis/index_files/figure-html/unnamed-chunk-7-1.png" width="672" /><img src="/post/2021/04/13/0413-bayesien-meta-analysis/index_files/figure-html/unnamed-chunk-7-2.png" width="672" /><img src="/post/2021/04/13/0413-bayesien-meta-analysis/index_files/figure-html/unnamed-chunk-7-3.png" width="672" /><img src="/post/2021/04/13/0413-bayesien-meta-analysis/index_files/figure-html/unnamed-chunk-7-4.png" width="672" /></p>
<pre class="r"><code>plot(mcmc2)</code></pre>
<p><img src="/post/2021/04/13/0413-bayesien-meta-analysis/index_files/figure-html/unnamed-chunk-7-5.png" width="672" /><img src="/post/2021/04/13/0413-bayesien-meta-analysis/index_files/figure-html/unnamed-chunk-7-6.png" width="672" /><img src="/post/2021/04/13/0413-bayesien-meta-analysis/index_files/figure-html/unnamed-chunk-7-7.png" width="672" /><img src="/post/2021/04/13/0413-bayesien-meta-analysis/index_files/figure-html/unnamed-chunk-7-8.png" width="672" /></p>
<pre class="r"><code>plot(mcmc3)</code></pre>
<p><img src="/post/2021/04/13/0413-bayesien-meta-analysis/index_files/figure-html/unnamed-chunk-7-9.png" width="672" /><img src="/post/2021/04/13/0413-bayesien-meta-analysis/index_files/figure-html/unnamed-chunk-7-10.png" width="672" /><img src="/post/2021/04/13/0413-bayesien-meta-analysis/index_files/figure-html/unnamed-chunk-7-11.png" width="672" /><img src="/post/2021/04/13/0413-bayesien-meta-analysis/index_files/figure-html/unnamed-chunk-7-12.png" width="672" /></p>
<pre class="r"><code>gelman.plot(mcmc1)</code></pre>
<p><img src="/post/2021/04/13/0413-bayesien-meta-analysis/index_files/figure-html/unnamed-chunk-8-1.png" width="672" /><img src="/post/2021/04/13/0413-bayesien-meta-analysis/index_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<pre class="r"><code>gelman.plot(mcmc2)</code></pre>
<p><img src="/post/2021/04/13/0413-bayesien-meta-analysis/index_files/figure-html/unnamed-chunk-8-3.png" width="672" /><img src="/post/2021/04/13/0413-bayesien-meta-analysis/index_files/figure-html/unnamed-chunk-8-4.png" width="672" /></p>
<pre class="r"><code>gelman.diag(mcmc1)$mpsrf</code></pre>
<pre><code>## [1] 1.449146</code></pre>
<pre class="r"><code>gelman.diag(mcmc2)$mpsrf</code></pre>
<pre><code>## [1] 1.018798</code></pre>
<pre class="r"><code>gelman.diag(mcmc3)$mpsrf</code></pre>
<pre><code>## [1] 1.005499</code></pre>
<pre class="r"><code>gemtc::forest(relative.effect(mcmc3, t1 = &quot;Placebo&quot;))</code></pre>
<p><img src="/post/2021/04/13/0413-bayesien-meta-analysis/index_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>

</div>
</main>

<section class="appendix">


<div>
  <div class="side side-left"><h3>Author&#39;s bio</h3></div>
  <div>





<div><a href="https://jackmd.netlify.app">Jiewen Tsai</a> is a PhD student in Education of National ChengChi University, Taiwan.</div>


</div>
</div>






<div>
  <div class="side side-left"><h3>Reuse</h3></div>
  <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>.
</div>






<div>
  <div class="side side-left"><h3>Citation</h3></div>
  <p>For attribution, please cite this work as</p>
  <pre><code class="no-highlight">Jiewen Tsai (2021). 0413 bayesien meta-analysis. ⌾ JackMD. /post/2021/04/13/0413-bayesien-meta-analysis/</code></pre>
  <p>BibTeX citation</p>
  <pre><code class="no-highlight">@misc{
  title = "0413 bayesien meta-analysis",
  author = "Jiewen Tsai",
  year = "2021",
  journal = "⌾ JackMD",
  note = "/post/2021/04/13/0413-bayesien-meta-analysis/"
}</code></pre>
</div>

</section>



<nav class="post-nav">
  <span class="nav-next">&larr; <a href="/post/2021/04/10/structural-topic-modeling-a-trial/" title=Next&#32;post&#32;(older)>Structural topic modeling: a trial</a></span>
  &hercon;
  <span class="nav-prev"><a href="/post/2021/04/25/make-slides-by-r-markdown-beamer/" title=Previous&#32;post&#32;(newer)>Make Slides by R Markdown Beamer</a> &rarr;</span>
</nav>




<section class="comments">
  <div id="disqus_thread"></div>
  <script>
  var disqus_config = function () {
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var disqus_js = '//https-jackmd-netlify-app.disqus.com/embed.js';
    var d = document, s = d.createElement('script');
    s.src = disqus_js; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    var t = d.getElementById('disqus_thread');
    var b = false, l = function(scroll) {
      if (b) return;
      (d.head || d.body).appendChild(s); b = true;
      if (scroll) t.scrollIntoView();
    }
    s.onerror = function(e) {
      if (sessionStorage.getItem('failure-note')) return;
      t.innerText = 'Sorry, but you cannot make comments because Disqus failed to load for some reason. It is known to be blocked in China. If you are sure it is not blocked in your region, please refresh the page. 中国大陆地区读者需要翻墙才能发表评论。';
      t.style.border = '1px dashed';
      t.style.padding = '.5em';
      t.style.background = 'lightyellow';
      sessionStorage.setItem('failure-note', true);
    };
    
    if (location.hash.match(/^#comment-[0-9]+$/)) return l(true);
    var c = function() {
      if (b) return;
      var rect = t.getBoundingClientRect();
      if (rect.top < window.innerHeight && rect.bottom >= 0) l();
    };
    window.addEventListener('load', c);
    d.addEventListener('scroll', c);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>


</div>


  <footer>
  <script async src="//yihui.org/js/center-img.js"></script>



<script src="//yihui.org/js/math-code.js"></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>



<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-183991274-1', 'auto');
	
	ga('send', 'pageview');
}
</script>



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script>
hljs.configure({languages: []});
hljs.initHighlightingOnLoad();
</script>


  <div class="footer">
  
  <ul class="copyright">
    <li>© <a href="/">Jiewen Tsai</a> 2021</li>
  </ul>
  
  <ul>
    
    <li>
      <a href="https://github.com/tsai-jiewen">Github</a>
    </li>
    
    <li>
      <a href="/index.xml">RSS</a>
    </li>
    
    <li id="menu-edit">
      <a href="#">Suggest an edit</a>
    </li>
    
    <li>
      <a href="#">Back to top</a>
    </li>
    
  </ul>
  </div>
  
  </footer>
  <script async src="/js/features.js" data-page-features="[null,[&#34;&#43;sidenotes&#34;],null]"></script>
  </body>
</html>

