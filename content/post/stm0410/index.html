---
title: 'Structural topic modeling: a trail'
author: "Jiewen Tsai"
date: '2021-04-10'
tags:
- R
- STM
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>


<ul>
<li>link here: <a href="https://blogs.uoregon.edu/rclub/2016/04/05/structural-topic-modeling/">structural topic modeling | R Club (uoregon.edu)</a></li>
<li><a href="file:///C:/Users/GameToGo/Downloads/stmVignette.pdf">stmVignette.pdf</a></li>
<li><a href="https://github.com/dondealban/learning-stm">learning stm</a></li>
</ul>
<div id="using-dt-and-higher-education" class="section level2">
<h2>using DT and Higher Education</h2>
<pre class="r"><code>#dtc160 &lt;- convert2df(
#  file = &quot;DTHghEdCov160.bib&quot;, 
#  dbsource = &quot;scopus&quot;, 
#  format = &quot;bibtex&quot;
#  )
#dtnc1667 &lt;- convert2df(
#  file = &quot;DTHghEdNCov1667.bib&quot;, 
#  dbsource = &quot;scopus&quot;, 
#  format = &quot;bibtex&quot;
#  )</code></pre>
<div id="select-variables" class="section level3">
<h3>select variables</h3>
<p>select Document Title (TI), Keywords associated by SCOPUS or ISI database (ID), Authors’ Keywords (DE) and Abstract (AB), then combined to one variable.</p>
<pre class="r"><code>#dtc160_2 &lt;- dtc160 %&gt;%
#  select(c(TI, DE, ID, AB)) %&gt;%
#  unite(col = response, sep = &#39; &#39;) %&gt;%
#  bind_cols(year = dtc160$PY, title = dtc160$TI) %&gt;%
#  mutate(treatment = 1)

#dtnc1667_2 &lt;- dtnc1667 %&gt;%
#  select(c(TI, DE, ID, AB)) %&gt;%
#  unite(col = response, sep = &#39; &#39;) %&gt;%
#  bind_cols(year = dtnc1667$PY, title = dtnc1667$TI) %&gt;%
#  mutate(treatment = 0)

#dt_com &lt;- bind_rows(dtc160_2, dtnc1667_2)
# write_csv(dt_com, &#39;dt_com.csv&#39;)</code></pre>
</div>
<div id="text-processing" class="section level3">
<h3>text processing</h3>
<pre class="r"><code>dt_com &lt;- read_csv(&#39;dt_com.csv&#39;)</code></pre>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   response = col_character(),
##   year = col_double(),
##   title = col_character(),
##   treatment = col_double()
## )</code></pre>
<pre class="r"><code>dt_cps &lt;- corpus(dt_com, text_field = &#39;response&#39;)
docvars(dt_cps)$text &lt;- as.character(dt_cps)
dt_fdm &lt;- dt_cps %&gt;% 
  dfm(stem = TRUE, 
      remove = stopwords(&#39;english&#39;), 
      remove_punct = TRUE) %&gt;% 
  # exclude words that appear too little or too much.
  dfm_trim(termfreq_type = &#39;quantile&#39;,
           min_termfreq = 0.01,
           max_termfreq = 0.99,)</code></pre>
<pre><code>## Warning: &#39;dfm.corpus()&#39; is deprecated. Use &#39;tokens()&#39; first.</code></pre>
<pre><code>## Warning: &#39;...&#39; should not be used for tokens() arguments; use &#39;tokens()&#39; first.</code></pre>
<pre><code>## Warning: &#39;remove&#39; is deprecated; use dfm_remove() instead</code></pre>
<pre><code>## Warning: &#39;stem&#39; is deprecated; use dfm_wordstem() instead</code></pre>
<pre class="r"><code>out &lt;- convert(dt_fdm, to = &#39;stm&#39;)
out$meta$treatment &lt;- as.factor(out$meta$treatment)

# fit structural topic models
dt_stm &lt;- stm(documents = out$documents,
              vocab = out$vocab,
              data = out$meta,
              prevalence =~ treatment + s(year) + treatment:s(year),
              K = 10, 
              verbose = FALSE)
plot.STM(dt_stm, type = &quot;summary&quot;) </code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code># plot.STM(dt_stm, type = &quot;hist&quot;)
plot.STM(dt_stm, type = &quot;perspectives&quot;, topics = c(3,9))</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<pre class="r"><code>plot.STM(dt_stm, type = &quot;perspectives&quot;, topics = c(6,8))</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-4-3.png" width="672" /></p>
<pre class="r"><code># estimate effect
dt_est &lt;- estimateEffect(1:10 ~ treatment + s(year), dt_stm,
                        meta = out$meta)
summary(dt_est)</code></pre>
<pre><code>## 
## Call:
## estimateEffect(formula = 1:10 ~ treatment + s(year), stmobj = dt_stm, 
##     metadata = out$meta)
## 
## 
## Topic 1:
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.09398    0.01749   5.373 8.72e-08 ***
## treatment1  -0.02699    0.02273  -1.188    0.235    
## s(year)1     0.01423    0.04106   0.347    0.729    
## s(year)2    -0.01818    0.04691  -0.388    0.698    
## s(year)3     0.02056    0.03308   0.622    0.534    
## s(year)4    -0.02133    0.02665  -0.800    0.424    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Topic 2:
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.113801   0.015004   7.585 5.29e-14 ***
## treatment1  -0.008453   0.020292  -0.417    0.677    
## s(year)1    -0.051664   0.039314  -1.314    0.189    
## s(year)2     0.017276   0.043036   0.401    0.688    
## s(year)3    -0.043386   0.030560  -1.420    0.156    
## s(year)4    -0.018036   0.021943  -0.822    0.411    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Topic 3:
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.08687    0.01507   5.763  9.7e-09 ***
## treatment1  -0.06448    0.02152  -2.997 0.002765 ** 
## s(year)1     0.07074    0.04121   1.717 0.086191 .  
## s(year)2    -0.04161    0.04648  -0.895 0.370789    
## s(year)3     0.01937    0.03072   0.631 0.528433    
## s(year)4     0.09262    0.02584   3.584 0.000347 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Topic 4:
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.126263   0.018415   6.856 9.64e-12 ***
## treatment1  -0.037673   0.023572  -1.598    0.110    
## s(year)1     0.056103   0.044572   1.259    0.208    
## s(year)2     0.011195   0.051713   0.216    0.829    
## s(year)3    -0.023379   0.036618  -0.638    0.523    
## s(year)4    -0.001865   0.026440  -0.071    0.944    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Topic 5:
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.0589951  0.0128270   4.599 4.53e-06 ***
## treatment1  -0.0276296  0.0168874  -1.636    0.102    
## s(year)1    -0.0184754  0.0313107  -0.590    0.555    
## s(year)2     0.0252686  0.0373782   0.676    0.499    
## s(year)3    -0.0037361  0.0247309  -0.151    0.880    
## s(year)4    -0.0004999  0.0193022  -0.026    0.979    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Topic 6:
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.120253   0.017667   6.807 1.35e-11 ***
## treatment1  -0.060349   0.021991  -2.744  0.00613 ** 
## s(year)1    -0.017150   0.043224  -0.397  0.69158    
## s(year)2    -0.007851   0.052026  -0.151  0.88007    
## s(year)3     0.038996   0.034734   1.123  0.26171    
## s(year)4    -0.025965   0.026344  -0.986  0.32445    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Topic 7:
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.15228    0.01805   8.438   &lt;2e-16 ***
## treatment1  -0.05208    0.02111  -2.467   0.0137 *  
## s(year)1    -0.06622    0.04255  -1.556   0.1199    
## s(year)2    -0.01091    0.04991  -0.219   0.8269    
## s(year)3    -0.05670    0.03407  -1.664   0.0962 .  
## s(year)4    -0.03694    0.02597  -1.423   0.1550    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Topic 8:
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.06562    0.01320   4.972 7.24e-07 ***
## treatment1  -0.03863    0.01749  -2.209   0.0273 *  
## s(year)1     0.02276    0.03626   0.628   0.5303    
## s(year)2     0.01033    0.04268   0.242   0.8088    
## s(year)3     0.02457    0.02723   0.902   0.3669    
## s(year)4    -0.01304    0.02019  -0.646   0.5184    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Topic 9:
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.063493   0.015146   4.192  2.9e-05 ***
## treatment1   0.334733   0.025510  13.122  &lt; 2e-16 ***
## s(year)1    -0.008081   0.036640  -0.221   0.8255    
## s(year)2    -0.002988   0.044022  -0.068   0.9459    
## s(year)3     0.064461   0.030642   2.104   0.0355 *  
## s(year)4     0.037715   0.023435   1.609   0.1077    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Topic 10:
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.11800    0.01414   8.348   &lt;2e-16 ***
## treatment1  -0.01918    0.01939  -0.989    0.323    
## s(year)1    -0.00244    0.03872  -0.063    0.950    
## s(year)2     0.01958    0.04355   0.450    0.653    
## s(year)3    -0.04135    0.02863  -1.444    0.149    
## s(year)4    -0.01173    0.02201  -0.533    0.594    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="topic-trends" class="section level3">
<h3>topic trends</h3>
<pre class="r"><code># topic labels
dt_lab &lt;- labelTopics(dt_stm, topics = 1:10)
dt_lab</code></pre>
<pre><code>## Topic 1 Top Words:
##       Highest Prob: la, en, universidad, y, analyz, spain, el 
##       FREX: la, en, y, el, educacin, del, competencia 
##       Lift: 1.066, 125, actividad, aditiva, adulto, alfabetizacin, alumnado 
##       Score: en, la, y, el, educacin, del, que 
## Topic 2 Top Words:
##       Highest Prob: platform, mooc, colleg, govern, massiv, india, intellig 
##       FREX: mooc, textbook, colleg, platform, multimedia, massiv, algorithm 
##       Lift: bernard, centric, e-teach, fast-grow, strategic-bas, ugc, anti-corrupt 
##       Score: mooc, india, textbook, intellig, cloud, colleg, artifici 
## Topic 3 Top Words:
##       Highest Prob: questionnair, perceiv, test, intent, relationship, adopt, behavior 
##       FREX: tam, intent, nurs, accept, equat, hec, variabl 
##       Lift: -1.527, -2.079, -2.507, -iot, #x0027, 0,142, 0.021 
##       Score: intent, nurs, dil, tam, pakistan, histotechnolog, ule 
## Topic 4 Top Words:
##       Highest Prob: critic, uk, franci, taylor, cultur, issu, pedagogi 
##       FREX: informa, neoliber, refuge, trade, franci, taylor, transmedia 
##       Lift: 119, aa, anti-coloni, arcgi, az, bvi, chief 
##       Score: uk, informa, storytel, trade, neoliber, franci, taylor 
## Topic 5 Top Words:
##       Highest Prob: adult, languag, age, medic, care, =, femal 
##       FREX: patient, older, cancer, symptom, prostat, therapi, smoke 
##       Lift: bzw, cancer, digitalen, mellitus, orthograph, patient-cent, preclin 
##       Score: patient, prostat, cancer, adult, older, smoke, dementia 
## Topic 6 Top Words:
##       Highest Prob: modern, russian, scientif, electron, read, region, econom 
##       FREX: russian, russia, these, modern, e-journ, region, electron 
##       Lift: 0.005, 0.2, 0.679, 0.824, 10-year, 10th, 13.49 
##       Score: russian, russia, these, modern, scientif, economi, foreign 
## Topic 7 Top Words:
##       Highest Prob: badg, game, busi, motiv, sustain, instruct, realiti 
##       FREX: badg, gamif, vr, game-bas, gamifi, entrepreneuri, game 
##       Lift: co-evolut, digitally-rich, ef, georgia, mle, mmog, odb 
##       Score: badg, gamif, entrepreneuri, vr, game, game-bas, ar 
## Topic 8 Top Words:
##       Highest Prob: web, leadership, facebook, websit, market, degre, devic 
##       FREX: facebook, twitter, eportfolio, leadership, websit, 2.0, annot 
##       Lift: acid, cord, ct, cube, ejourn, folic, holder 
##       Score: facebook, caregiv, leadership, fa, sep, diet, eportfolio 
## Topic 9 Top Words:
##       Highest Prob: covid-19, pandem, industri, emerg, sustain, hei, generat 
##       FREX: covid-19, pandem, coronavirus, lockdown, revolut, crisi, hei 
##       Lift: atrium, cameroon, dar, nonprolifer, scrum, toronto, uni-q 
##       Score: covid-19, pandem, labor, lockdown, industri, crisi, coronavirus 
## Topic 10 Top Words:
##       Highest Prob: blend, lectur, feedback, framework, video, flip, enhanc 
##       FREX: flip, blend, feedback, music, lectur, tutor, video 
##       Lift: -19, -alon, -design, -flip, 0.06, 0.20, 0.41 
##       Score: flip, blend, feedback, video, lectur, music, invert</code></pre>
<pre class="r"><code># find head 5 papers&#39; titles
find_papers &lt;- function(x){
thoughts &lt;- findThoughts(dt_stm, texts = dt_com$response, n = 5, topics = x)
papers &lt;- dt_com %&gt;% 
    slice(c(thoughts$index[[1]])) %&gt;%
    select(title)
papers$title
}

# related papers
find_papers(1)</code></pre>
<pre><code>## [1] &quot;CONSUMPTION OF ADDICTIVE SUBSTANCES, TOBACCO, ALCOHOL AND MARIJUANA BY STUDENTS OF NORTH PORTUGAL [CONSUMO DE SUSTANCIAS ADICTIVAS, TABACO, ALCOHOL Y MARIHUANA, EN LOS ESTUDIANTES DEL NORTE DE PORTUGAL] [CONSUMO DE SUBSTNCIAS ADITIVAS, TABACO, LCOOL Y MARIJUANA, EM ESTUDANTES DO NORTE DE PORTUGAL]&quot;                                                                                                                                                                                                                                                                             
## [2] &quot;GAMING AS AN EDUCATIONAL MATERIAL FOR DIGITAL COMPETENCES IN EDUCATION FROM ACADEMIC SKILLS CENTRES [GAMING COMO INSTRUMENTO EDUCATIVO PARA UNA EDUCACIN EN COMPETENCIAS DIGITALES DESDE LOS ACADEMIC SKILLS CENTRES]&quot;                                                                                                                                                                                                                                                                                                                                                                  
## [3] &quot;DIGITAL CLASSROOMS IN HIGHER EDUCATION: THE CASE OF MEXICO [AULAS DIGITALES EN LA EDUCACIN SUPERIOR: CASO MXICO]&quot;                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
## [4] &quot;THE RELATIONSHIP BETWEEN LEARNING OBJECTS (LOS) AND THE DEVELOPMENT OF LISTENING SKILLS IN LANGUAGE STUDENTS [LA RELACIN ENTRE LOS OBJETOS VIRTUALES DE APRENDIZAJE Y EL DESARROLLO DE LA HABILIDAD DE ESCUCHA EN ESTUDIANTES DE LENGUAS]&quot;                                                                                                                                                                                                                                                                                                                                              
## [5] &quot;DIGITAL TECHNOLOGIES OF COMMUNICATION AND HIGHER EDUCATION: CONTRIBUTIONS FROM THEORY OF ACTIVITY IN TEACHING LEARNING PROCESSES [TECHNOLOGIES NUMERIQUES DE LA COMMUNICATION ET DE LENSEIGNEMENT SUPERIEUR: CONTRIBUTIONS DE LA THEORIE DE LACTIVIT DANS LES PROCESSUS DAPPRENTISSAGE DE LENSEIGNEMENT] [TECNOLOGIAS DIGITAIS DE COMUNICAO E ENSINO SUPERIOR: CONTRIBUIES DA TEORIA DA ATIVIDADE EM PROCESSOS DE ENSINO--APRENDIZAGEM] [TECNOLOGAS DIGITALES DE COMUNICACIN Y EDUCACIN SUPERIOR: CONTRIBUCIONES DESDE LA TEORA DE LA ACTIVIDAD EN LOS PROCESOS DE APRENDIZAJE DOCENTE]&quot;</code></pre>
<pre class="r"><code>find_papers(2)</code></pre>
<pre><code>## [1] &quot;COLLEGE STUDENT EMPLOYMENT DATA PLATFORM BASED ON FPGA AND MACHINE LEARNING&quot;                                                  
## [2] &quot;CHALLENGES FOR THE DEVELOPMENT OF SURVEYING AND MAPPING TECHNOLOGY IN THE AGE OF INTELLIGENCE []&quot;                             
## [3] &quot;ICT AND HIGHER EDUCATION IN ASSAM: IMPORTANCE OF MOOCS AND SWAYAM&quot;                                                            
## [4] &quot;SUCCESS FACTORS IN A MOOC MASSIVE DEVICE: QUESTIONS AND CHALLENGES&quot;                                                           
## [5] &quot;WHEN ETHICS AND LAW CLASH A LOOK AT THE ETHICAL, LEGAL, AND MORAL ISSUES ARISING FROM THE BOSTON COLLEGE BELFAST ORAL PROJECT&quot;</code></pre>
<pre class="r"><code>find_papers(3)</code></pre>
<pre><code>## [1] &quot;THE RELATIONSHIP OF PERSONAL INNOVATIVENESS, QUALITY OF DIGITAL RESOURCES AND GENERIC USABILITY WITH USERS SATISFACTION: A PAKISTANI PERSPECTIVE&quot;
## [2] &quot;ADOLESCENT HEALTH LITERACY: FACTORS EFFECTING USAGE AND EXPERTISE OF DIGITAL HEALTH LITERACY AMONG UNIVERSITIES STUDENTS IN PAKISTAN&quot;            
## [3] &quot;TESTING THE METUX MODEL IN HIGHER EDUCATION: INTERFACE AND TASK NEEDSATISFACTION PREDICT ENGAGEMENT, LEARNING, AND WELL-BEING&quot;                   
## [4] &quot;INVESTIGATING DIGITAL DISTRACTION AMONG PRE-SERVICE SCIENCE, TECHNOLOGY, AND MATHEMATICS TEACHERS IN NIGERIA&quot;                                    
## [5] &quot;PREDICTORS OF DIGITAL PIRACY AMONG TURKISH UNDERGRADUATE STUDENTS&quot;</code></pre>
<pre class="r"><code>find_papers(4)</code></pre>
<pre><code>## [1] &quot;GOING BEYOND THE GRID: LITERARY MAPPING AS CREATIVE READING&quot;                                                           
## [2] &quot;AWESOME WOMEN AND BAD FEMINISTS: THE ROLE OF ONLINE SOCIAL NETWORKS AND PEER SUPPORT FOR FEMINIST PRACTICE IN ACADEMIA&quot;
## [3] &quot;NEOLIBERALISM, TECHNOCRACY AND HIGHER EDUCATION EDITORS INTRODUCTION&quot;                                                  
## [4] &quot;THE VELVET CAGE OF EDUCATIONAL CON(PRO)SUMPTION&quot;                                                                       
## [5] &quot;REPRESENTATION WITHIN HIGHER EDUCATION CURRICULA: CONTEXTUALISING AND ADVOCATING FOR FEMINIST DIGITAL ACTIVISM&quot;</code></pre>
<pre class="r"><code>find_papers(5)</code></pre>
<pre><code>## [1] &quot;USER INTEREST IN DIGITAL HEALTH TECHNOLOGIES TO ENHANCE PHYSICAL ACTIVITY IN STUDENTS AND STAFF OF A UNIVERSITY [NUTZERINTERESSE AN MOBILEN DIGITALEN ASSISTENZSYSTEMEN ZUR FRDERUNG KRPERLICHER AKTIVITT BEI STUDIERENDEN UND MITARBEITERN EINER UNIVERSITT]&quot;
## [2] &quot;BRIEF, WEB-BASED INTERVENTIONS TO MOTIVATE SMOKERS WITH SCHIZOPHRENIA: RANDOMIZED CONTROLLED TRIAL&quot;                                                                                                                                                           
## [3] &quot;PHYSICAL OR OCCUPATIONAL THERAPY USE IN SYSTEMIC SCLEROSIS: A SCLERODERMA PATIENT-CENTERED INTERVENTION NETWORK COHORT STUDY&quot;                                                                                                                                 
## [4] &quot;A COMPARISON OF THE CHARACTERISTICS AND TREATMENT OUTCOMES OF MIGRANT AND AUSTRALIAN-BORN USERS OF A NATIONAL DIGITAL MENTAL HEALTH SERVICE&quot;                                                                                                                  
## [5] &quot;SCREEN USE AMONG YOUNG CHILDREN IN A CITY OF ARGENTINA&quot;</code></pre>
<pre class="r"><code>find_papers(6)</code></pre>
<pre><code>## [1] &quot;THE INVESTMENT ATTRACTIVENESS OF A REGIONAL MARKET OF EDUCATIONAL SERVICES AS THE BASIS OF ITS GLOBAL COMPETITIVENESS IN INDUSTRY 4.0&quot;
## [2] &quot;ABOUT RELEVANCE OF FUNDAMENTALISATION OF MATHEMATICAL TRAINING OF STUDENTS OF THE PEDAGOGICAL DIRECTIONS DURING THE DIGITAL ERA [ ]&quot;  
## [3] &quot;MONITORING OF THE CURRENT STATUS OF STUDENTS AS A MEANS OF INCREASING THE EFFECTIVENESS OF EDUCATIONAL PROCESS [ ]&quot;                   
## [4] &quot;NEW STATE STANDARDS OF HIGHER EDUCATION FOR TRAINING OF DIGITAL PERSONNEL IN THE CONDITIONS OF INDUSTRY 4.0&quot;                          
## [5] &quot;ANALYSIS OF UNDERDEVELOPMENT WHIRLPOOLS AS A TOOL OF MANAGING THE REGIONAL MARKET OF EDUCATION IN THE CONDITIONS OF INDUSTRY 4.0&quot;</code></pre>
<pre class="r"><code>find_papers(7)</code></pre>
<pre><code>## [1] &quot;REENGINEERING ENGINEERING EDUCATION AT THE UNIVERSITY OF LOS ANDES: THE REDINGE2 PILOT PROJECT&quot;                       
## [2] &quot;DIGITAL CURATION IN MUSEUMS&quot;                                                                                          
## [3] &quot;A DIDACTIC PEDAGOGICAL APPROACH TOWARD SUSTAINABLE ARCHITECTURAL EDUCATION THROUGH ROBOTIC TECTONICS&quot;                 
## [4] &quot;BEYOND THE MARGINS OF ACADEMIC EDUCATION: IDENTIFYING TRANSLATION INDUSTRY TRAINING PRACTICES THROUGH ACTION RESEARCH&quot;
## [5] &quot;A TANGIBLE USER INTERFACE TO FACILITATE LEARNING OF TRIGONOMETRY&quot;</code></pre>
<pre class="r"><code>find_papers(8)</code></pre>
<pre><code>## [1] &quot;A WEBOMETRIC ANALYSIS OF SELECT KNOWLEDGE PORTALS OF NATIONAL REPUTE IN INDIA&quot;                                                   
## [2] &quot;WEB 2.0 USE IN ACADEMIC LIBRARIES OF TOP RANKED ASIAN UNIVERSITIES&quot;                                                              
## [3] &quot;WHAT ENABLES DOCTORAL DEGREE HOLDERS TO GET A JOB? A JOURNEY THROUGH DOCTORAL STUDENTS&#39; SATISFACTION WITH EDUCATIONAL SERVICES&quot;  
## [4] &quot;SOCIAL MEDIA ADVERTISING EFFICIENCY ON HIGHER EDUCATION PROGRAMS&quot;                                                                
## [5] &quot;HIGHER EDUCATION AND DESTINATION OF THE YOUTH IN THE REPUBLIC OF THE MARSHALL ISLANDS: IMPLICATION FOR CLIMATE-INDUCED MIGRATION&quot;</code></pre>
<pre class="r"><code>find_papers(9)</code></pre>
<pre><code>## [1] &quot;DIGITAL TRANSFORMATION OF EVERYDAY LIFE HOW COVID-19 PANDEMIC TRANSFORMED THE BASIC EDUCATION OF THE YOUNG GENERATION AND WHY INFORMATION MANAGEMENT RESEARCH SHOULD CARE?&quot;
## [2] &quot;THE COVID-19 PANDEMIC AS AN OPPORTUNITY TO FOSTER THE SUSTAINABLE DEVELOPMENT OF TEACHING IN HIGHER EDUCATION&quot;                                                             
## [3] &quot;STUDYING ABROAD AT HOME: THE MEANING OF EDUCATION ABROAD DURING THE PANDEMIC&quot;                                                                                              
## [4] &quot;HIGHER EDUCATION IN TROUBLED TIMES: ON THE IMPACT OF COVID-19 IN ITALY&quot;                                                                                                    
## [5] &quot;CONTINUITY OF ACADEMIC LIBRARY SERVICES DURING THE PANDEMIC: THE UNIVERSITY OF TORONTO LIBRARIES&#39; RESPONSE&quot;</code></pre>
<pre class="r"><code># plotQuote(thoughts5, main = &quot;Topic 5&quot;)</code></pre>
<pre class="r"><code># plot
plot(dt_est,
     covariate = &#39;treatment&#39;,
     cov.value1 = &quot;1&quot;,
     cov.value2 = &quot;0&quot;,
     method = &quot;difference&quot;, 
     verbose.labels = F,
     topics = c(1:10), 
     xlim = c(-0.5:0.5))</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code>par(mfrow=c(2,3))
for (i in c(9, 10 ,3, 7, 2, 4)){
plot(dt_est, &quot;year&quot;, method = &quot;continuous&quot;, topics = i, main = paste0(dt_lab$prob[i,1:3], collapse = &quot;, &quot;), printlegend = F)
}</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code>par(mfrow=c(2,3))
for (i in c(8, 1, 5, 6)){
plot(dt_est, &quot;year&quot;, method = &quot;continuous&quot;, topics = i, main = paste0(dt_lab$prob[i,1:3], collapse = &quot;, &quot;), printlegend = F)
}</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
</div>
<div id="interaction-effect-with-time" class="section level3">
<h3>interaction effect (with time)</h3>
<pre class="r"><code>par(mfrow=c(2,2))
for (i in c(3, 6:8)){
  plot(dt_est, &quot;year&quot;, method = &quot;continuous&quot;, 
     covariate = &quot;year&quot;, topics = c(i), linecol = &#39;red&#39;,
     moderator = &#39;treatment&#39;, moderator.value = &#39;1&#39;,
     printlegend = F, xaxt = &quot;s&quot;, ylim = c(0, 0.2), #xlim = c(2019, 2021), 
     xlab = &quot;covid (red) vs non-covid (blue)&quot;, main = paste(&#39;Topic&#39;, i, sep = &#39; &#39;))
  plot(dt_est, &quot;year&quot;, method = &quot;continuous&quot;, 
     covariate = &quot;year&quot;, topics = c(i), linecol = &#39;blue&#39;,
     moderator = &#39;treatment&#39;, moderator.value = &#39;0&#39;,
     printlegend = F, xaxt = &quot;s&quot;, ylim = c(0, 0.2), #xlim = c(2019, 2021), 
     , add = T)
}</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>plot(dt_est, &quot;year&quot;, method = &quot;continuous&quot;, 
     covariate = &quot;year&quot;, topics = c(9), linecol = &#39;red&#39;,
     moderator = &#39;treatment&#39;, moderator.value = &#39;1&#39;,
     printlegend = F, xaxt = &quot;s&quot;, ylim = c(0, 0.5), #xlim = c(2019, 2021), 
     xlab = &quot;covid (red) vs non-covid (blue)&quot;, main = paste(&#39;Topic&#39;, 9, sep = &#39; &#39;))
  plot(dt_est, &quot;year&quot;, method = &quot;continuous&quot;, 
     covariate = &quot;year&quot;, topics = c(9), linecol = &#39;blue&#39;,
     moderator = &#39;treatment&#39;, moderator.value = &#39;0&#39;,
     printlegend = F, xaxt = &quot;s&quot;, ylim = c(0, 0.5), #xlim = c(2019, 2021), 
     , add = T)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<pre class="r"><code>#dt_com2 &lt;- dt_com %&gt;% filter(year == c(2019:2021))
#dt_cps2 &lt;- corpus(dt_com2, text_field = &#39;response&#39;)
#docvars(dt_cps2)$text &lt;- as.character(dt_cps2)
#dt_dfm2 &lt;- dfm(dt_cps2, 
#            stem = TRUE, 
#            remove = stopwords(&#39;english&#39;), 
#            remove_punct = TRUE)
#out2 &lt;- convert(dt_dfm2, to = &#39;stm&#39;)
#out2$meta$treatment &lt;- as.factor(out2$meta$treatment)</code></pre>
<pre class="r"><code>#dt_stm2 &lt;- stm(documents = out2$documents,
#              vocab = out2$vocab,
#              data = out2$meta,
#              prevalence =~ treatment * year,
#              K = 10, verbose = FALSE)

## interaction
dt_est2 &lt;- estimateEffect(1:10 ~ treatment*s(year), dt_stm,
                         meta = out$meta)</code></pre>
<pre><code>## Warning in estimateEffect(1:10 ~ treatment * s(year), dt_stm, meta = out$meta): Covariate matrix is singular.  See the details of ?estimateEffect() for some common causes.
##              Adding a small prior 1e-5 for numerical stability.</code></pre>
<pre class="r"><code>summary(dt_est2)</code></pre>
<pre><code>## 
## Call:
## estimateEffect(formula = 1:10 ~ treatment * s(year), stmobj = dt_stm, 
##     metadata = out$meta)
## 
## 
## Topic 1:
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          0.091787   0.016447   5.581 2.76e-08 ***
## treatment1           0.272871  35.636255   0.008    0.994    
## s(year)1             0.014559   0.042800   0.340    0.734    
## s(year)2            -0.010768   0.047462  -0.227    0.821    
## s(year)3             0.014429   0.037054   0.389    0.697    
## s(year)4            -0.007326   0.025763  -0.284    0.776    
## treatment1:s(year)1  0.731679  70.660451   0.010    0.992    
## treatment1:s(year)2  0.035355  67.641052   0.001    1.000    
## treatment1:s(year)3 -0.462284  52.259379  -0.009    0.993    
## treatment1:s(year)4 -0.330612  35.635728  -0.009    0.993    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Topic 2:
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          0.11874    0.01558   7.621 4.01e-14 ***
## treatment1          -0.01793   32.95943  -0.001    1.000    
## s(year)1            -0.06483    0.04082  -1.588    0.112    
## s(year)2             0.01967    0.04577   0.430    0.667    
## s(year)3            -0.04234    0.03244  -1.305    0.192    
## s(year)4            -0.03746    0.02444  -1.533    0.126    
## treatment1:s(year)1  0.94793   64.52431   0.015    0.988    
## treatment1:s(year)2 -0.37817   62.54126  -0.006    0.995    
## treatment1:s(year)3  0.07235   48.27909   0.001    0.999    
## treatment1:s(year)4  0.05386   32.95985   0.002    0.999    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Topic 3:
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          0.08526    0.01529   5.575 2.85e-08 ***
## treatment1           0.11696   33.37100   0.004   0.9972    
## s(year)1             0.06981    0.03836   1.820   0.0689 .  
## s(year)2            -0.03765    0.04587  -0.821   0.4119    
## s(year)3             0.01641    0.03265   0.503   0.6153    
## s(year)4             0.10334    0.02588   3.993 6.80e-05 ***
## treatment1:s(year)1  0.11518   65.64684   0.002   0.9986    
## treatment1:s(year)2  0.33669   63.34823   0.005   0.9958    
## treatment1:s(year)3 -0.38314   48.73792  -0.008   0.9937    
## treatment1:s(year)4 -0.20431   33.37158  -0.006   0.9951    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Topic 4:
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          0.120917   0.017545   6.892 7.58e-12 ***
## treatment1          -0.055980  37.876554  -0.001    0.999    
## s(year)1             0.066840   0.046126   1.449    0.147    
## s(year)2             0.004103   0.056078   0.073    0.942    
## s(year)3            -0.009506   0.036819  -0.258    0.796    
## s(year)4            -0.001671   0.029261  -0.057    0.954    
## treatment1:s(year)1 -0.072286  72.958307  -0.001    0.999    
## treatment1:s(year)2 -0.930096  70.732002  -0.013    0.990    
## treatment1:s(year)3  0.413953  55.146900   0.008    0.994    
## treatment1:s(year)4  0.019084  37.876213   0.001    1.000    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Topic 5:
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          0.057205   0.012778   4.477 8.05e-06 ***
## treatment1          -0.034096  27.500144  -0.001    0.999    
## s(year)1            -0.014685   0.032083  -0.458    0.647    
## s(year)2             0.030153   0.037691   0.800    0.424    
## s(year)3             0.002108   0.028340   0.074    0.941    
## s(year)4            -0.005092   0.020619  -0.247    0.805    
## treatment1:s(year)1  0.414060  54.004467   0.008    0.994    
## treatment1:s(year)2 -0.204953  52.375789  -0.004    0.997    
## treatment1:s(year)3  0.046557  40.485734   0.001    0.999    
## treatment1:s(year)4  0.020678  27.500371   0.001    0.999    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Topic 6:
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          0.12279    0.01809   6.788 1.53e-11 ***
## treatment1           0.02049   36.96377   0.001    1.000    
## s(year)1            -0.01651    0.04409  -0.375    0.708    
## s(year)2            -0.01533    0.04782  -0.321    0.749    
## s(year)3             0.04183    0.03624   1.154    0.249    
## s(year)4            -0.03634    0.02789  -1.303    0.193    
## treatment1:s(year)1 -0.02189   71.83907   0.000    1.000    
## treatment1:s(year)2 -0.03271   69.97512   0.000    1.000    
## treatment1:s(year)3 -0.13262   53.91790  -0.002    0.998    
## treatment1:s(year)4 -0.06260   36.96351  -0.002    0.999    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Topic 7:
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          0.15483    0.01892   8.183 5.17e-16 ***
## treatment1           0.42929   35.91003   0.012    0.990    
## s(year)1            -0.05691    0.04238  -1.343    0.179    
## s(year)2            -0.02801    0.05257  -0.533    0.594    
## s(year)3            -0.05087    0.03367  -1.511    0.131    
## s(year)4            -0.03219    0.02929  -1.099    0.272    
## treatment1:s(year)1 -0.96142   70.97523  -0.014    0.989    
## treatment1:s(year)2 -0.34231   68.07661  -0.005    0.996    
## treatment1:s(year)3 -0.50103   52.54378  -0.010    0.992    
## treatment1:s(year)4 -0.49101   35.91019  -0.014    0.989    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Topic 8:
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          0.067360   0.013439   5.012  5.9e-07 ***
## treatment1          -0.325678  29.266228  -0.011    0.991    
## s(year)1             0.009253   0.033758   0.274    0.784    
## s(year)2             0.020359   0.040522   0.502    0.615    
## s(year)3             0.017278   0.028189   0.613    0.540    
## s(year)4            -0.016616   0.022502  -0.738    0.460    
## treatment1:s(year)1  0.413493  57.853141   0.007    0.994    
## treatment1:s(year)2  0.436699  54.685687   0.008    0.994    
## treatment1:s(year)3  0.201325  42.528978   0.005    0.996    
## treatment1:s(year)4  0.299892  29.266267   0.010    0.992    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Topic 9:
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          0.064559   0.014566   4.432 9.89e-06 ***
## treatment1           0.670356  32.497094   0.021   0.9835    
## s(year)1            -0.011661   0.037371  -0.312   0.7550    
## s(year)2             0.002989   0.042224   0.071   0.9436    
## s(year)3             0.052124   0.030727   1.696   0.0900 .  
## s(year)4             0.044446   0.023782   1.869   0.0618 .  
## treatment1:s(year)1 -0.206758  63.344363  -0.003   0.9974    
## treatment1:s(year)2  0.571510  60.971506   0.009   0.9925    
## treatment1:s(year)3 -0.669419  47.359443  -0.014   0.9887    
## treatment1:s(year)4 -0.354853  32.497167  -0.011   0.9913    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## 
## Topic 10:
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          0.116535   0.015528   7.505 9.57e-14 ***
## treatment1           0.351750  30.890409   0.011    0.991    
## s(year)1             0.003599   0.035644   0.101    0.920    
## s(year)2             0.013768   0.041458   0.332    0.740    
## s(year)3            -0.040247   0.029451  -1.367    0.172    
## s(year)4            -0.011648   0.024192  -0.481    0.630    
## treatment1:s(year)1  0.058749  60.523577   0.001    0.999    
## treatment1:s(year)2 -1.036386  58.091256  -0.018    0.986    
## treatment1:s(year)3 -0.113051  45.420713  -0.002    0.998    
## treatment1:s(year)4 -0.378051  30.890589  -0.012    0.990    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>#plot.STM(dt_stm2, type = &quot;summary&quot;) 
par(mfrow=c(1,2))
plot(dt_est2, &quot;year&quot;, method = &quot;continuous&quot;, 
     covariate = &quot;year&quot;, topics = c(9), linecol = &#39;red&#39;,
     moderator = &#39;treatment&#39;, moderator.value = &#39;1&#39;,
     printlegend = F, xaxt = &quot;s&quot;, ylim = c(0, 0.5), xlim = c(2019, 2021), 
     xlab = &quot;covid (red) vs non-covid (blue)&quot;, main = paste(&#39;Topic&#39;, 9, sep = &#39; &#39;))
plot(dt_est2, &quot;year&quot;, method = &quot;continuous&quot;, 
     covariate = &quot;year&quot;, topics = c(9), linecol = &#39;blue&#39;,
     moderator = &#39;treatment&#39;, moderator.value = &#39;0&#39;,
     printlegend = F, xaxt = &quot;s&quot;, ylim = c(0, 0.5), xlim = c(2019, 2021)#, add = T
     )</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-11-1.png" width="672" />
Estimations of interaction effects had some problems, and there was not significant on any topic.</p>
</div>
<div id="topic-corr" class="section level3">
<h3>topic corr</h3>
<pre class="r"><code>cormat &lt;- topicCorr(dt_stm)
plot(cormat)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="model-select" class="section level3">
<h3>model select</h3>
<pre class="r"><code>#poliblogSelect &lt;- selectModel(out$documents, out$vocab, K = 20,
#prevalence =~ treatment + s(year), max.em.its = 75, data = out$meta, runs = 20, seed #= 8458159)</code></pre>
<pre class="r"><code>#storage &lt;- searchK(out$documents, out$vocab, K = c(7, 10),
#prevalence =~ treatment + s(year), data = out$meta)
#plot(storage)</code></pre>
</div>
</div>
